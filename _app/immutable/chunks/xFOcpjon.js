import"./DsnmJJEf.js";import{y,x as o,z as m,I as H,p as J,f as x,a as S,b as d,c as K,s as L,d as z,r as b,t as M,e as Y}from"./vp8LXHGR.js";import{s as P,a as T}from"./pja_h9dl.js";import{p as C,i as A}from"./Dl5udER_.js";import{a as I,e as U,d as N}from"./Bs1WACQy.js";import{t as O,s as Q}from"./-QCXjV-k.js";import{E as V}from"./DTG56X07.js";class W{#t;#e=y(()=>this.#t());get items(){return o(this.#e)}set items(t){m(this.#e,t)}#s;#r=y(()=>this.#s());get sorters(){return o(this.#r)}set sorters(t){m(this.#r,t)}#i;#a=y(()=>this.#i?.());get default_key(){return o(this.#a)}set default_key(t){m(this.#a,t)}#_=H("");get active_key(){return o(this.#_)}set active_key(t){m(this.#_,t,!0)}#o=y(()=>this.sorters.find(t=>t.key===this.active_key));get active_sorter(){return o(this.#o)}set active_sorter(t){m(this.#o,t)}#l=y(()=>this.active_sorter?.fn);get active_sort_fn(){return o(this.#l)}set active_sort_fn(t){m(this.#l,t)}#n=y(()=>{const t=[...this.items];return this.active_sort_fn?t.sort(this.active_sort_fn):t});get sorted_items(){return o(this.#n)}set sorted_items(t){m(this.#n,t)}constructor(t,a,r){this.#t=t,this.#s=a,this.#i=r,this.update_active_key()}update_active_key(){const t=this.sorters,a=this.default_key;if(!t.length){this.active_key="";return}if(a&&t.some(r=>r.key===a)){this.active_key=a;return}if(!t.some(r=>r.key===this.active_key)){const r=t[0];r?this.active_key=r.key:(console.error("Unexpected empty sorters array after length check"),this.active_key="")}}}const nt=(k,t,a,r="asc")=>{const v=r==="desc"?-1:1;return{key:k,label:t,fn:(_,l)=>{const n=v*String(_[a]).localeCompare(String(l[a]));return n!==0?n:l.cid-_.cid}}},ct=(k,t,a,r="asc")=>({key:k,label:t,fn:(v,_)=>{const l=v[a],n=_[a],w=r==="asc"?l<n?-1:l>n?1:0:l>n?-1:l<n?1:0;return w!==0?w:_.cid-v.cid}});var X=x("<option> </option>"),Z=x('<label><small class="pr_xs3 white_space_nowrap">sort by</small> <select class="compact plain font_size_sm"></select></label>'),p=x('<div class="p_md"> </div>'),$=x("<li><!></li>"),tt=x("<ul></ul>"),et=x("<!> <!>",1);function vt(k,t){J(t,!0);const a=C(t,"sorters",3,V),r=C(t,"show_sort_controls",3,!1),v=C(t,"no_items",3,"[no items available]"),_=new W(()=>t.items,()=>a(),()=>t.sort_key_default),l=y(()=>{if((!t.exclude_ids||t.exclude_ids.length===0)&&!t.filter&&!_.active_sort_fn)return t.items;let e=t.items;return t.exclude_ids&&t.exclude_ids.length>0&&(e=e.filter(s=>!t.exclude_ids.includes(s.id))),t.filter&&(e=e.filter(t.filter)),_.active_sort_fn&&(e===t.items&&(e=[...e]),e.sort(_.active_sort_fn)),e});var n=et(),w=S(n);{var j=e=>{var s=Z();I(s,()=>({...t.label_attrs,class:`p_xs row gap_xs2 mb_0 ${t.label_attrs?.class??""}`}));var f=L(z(s),2);U(f,21,()=>_.sorters,u=>u.key,(u,c)=>{var i=X(),h=z(i,!0);b(i);var g={};M(()=>{P(h,o(c).label),g!==(g=o(c).key)&&(i.value=(i.__value=o(c).key)??"")}),d(u,i)}),b(f),b(s),N(f,()=>_.active_key,u=>_.active_key=u),O(3,s,()=>Q),d(e,s)};A(w,e=>{r()&&_.sorters.length>1&&e(j)})}var q=L(w,2);{var B=e=>{var s=Y(),f=S(s);{var u=i=>{var h=Y(),g=S(h);{var F=E=>{var R=p(),G=z(R,!0);b(R),M(()=>P(G,v())),d(E,R)};A(g,E=>{v()&&E(F)})}d(i,h)},c=i=>{var h=Y(),g=S(h);T(g,v),d(i,h)};A(f,i=>{typeof v()=="string"?i(u):i(c,!1)})}d(e,s)},D=e=>{var s=tt();I(s,()=>({...t.list_attrs,class:`unstyled ${t.list_attrs?.class??""}`})),U(s,21,()=>o(l),f=>f.id,(f,u)=>{var c=$();I(c,()=>({...t.item_attrs}));var i=z(c);T(i,()=>t.children,()=>o(u)),b(c),d(f,c)}),b(s),d(e,s)};A(q,e=>{o(l).length===0?e(B):e(D,!1)})}d(k,n),K()}export{vt as S,nt as a,ct as s};
