import"./DsnmJJEf.js";import{j as y,i as _,l as h,k as J,p as K,f as x,a as S,b as m,c as N,s as L,d as j,r as b,t as M,e as Y}from"./DsYFF3e0.js";import{s as P,a as T}from"./D6t6EFf3.js";import{p as z,i as A}from"./Nwe5dM3j.js";import{k as C,j as q,x as O}from"./dRtQjgBD.js";import{t as Q,s as U}from"./R2QwTmpq.js";import{E as V}from"./23rF6zAW.js";class W{#t;#e=y(()=>this.#t());get items(){return _(this.#e)}set items(t){h(this.#e,t)}#s;#r=y(()=>this.#s());get sorters(){return _(this.#r)}set sorters(t){h(this.#r,t)}#i;#a=y(()=>this.#i?.());get default_key(){return _(this.#a)}set default_key(t){h(this.#a,t)}#_=J("");get active_key(){return _(this.#_)}set active_key(t){h(this.#_,t,!0)}#l=y(()=>this.sorters.find(t=>t.key===this.active_key));get active_sorter(){return _(this.#l)}set active_sorter(t){h(this.#l,t)}#o=y(()=>this.active_sorter?.fn);get active_sort_fn(){return _(this.#o)}set active_sort_fn(t){h(this.#o,t)}#n=y(()=>{const t=[...this.items];return this.active_sort_fn?t.sort(this.active_sort_fn):t});get sorted_items(){return _(this.#n)}set sorted_items(t){h(this.#n,t)}constructor(t,i,l){this.#t=t,this.#s=i,this.#i=l,this.update_active_key()}update_active_key(){const t=this.sorters,i=this.default_key;if(!t.length){this.active_key="";return}if(i&&t.some(l=>l.key===i)){this.active_key=i;return}t.some(l=>l.key===this.active_key)||(this.active_key=t[0].key)}}const nt=(k,t,i,l="asc")=>{const v=l==="desc"?-1:1;return{key:k,label:t,fn:(a,o)=>{const n=v*String(a[i]).localeCompare(String(o[i]));return n!==0?n:o.cid-a.cid}}},ct=(k,t,i,l="asc")=>({key:k,label:t,fn:(v,a)=>{const o=v[i],n=a[i],w=l==="asc"?o<n?-1:o>n?1:0:o>n?-1:o<n?1:0;return w!==0?w:a.cid-v.cid}});var X=x("<option> </option>"),Z=x('<label><small class="pr_xs3 white_space_nowrap">sort by</small> <select class="compact plain font_size_sm"></select></label>'),p=x('<div class="p_md"> </div>'),$=x("<li><!></li>"),tt=x("<ul></ul>"),et=x("<!> <!>",1);function vt(k,t){K(t,!0);const i=z(t,"sorters",3,V),l=z(t,"show_sort_controls",3,!1),v=z(t,"no_items",3,"[no items available]"),a=new W(()=>t.items,()=>i(),()=>t.sort_key_default),o=y(()=>{if((!t.exclude_ids||t.exclude_ids.length===0)&&!t.filter&&!a.active_sort_fn)return t.items;let e=t.items;return t.exclude_ids&&t.exclude_ids.length>0&&(e=e.filter(s=>!t.exclude_ids.includes(s.id))),t.filter&&(e=e.filter(t.filter)),a.active_sort_fn&&(e===t.items&&(e=[...e]),e.sort(a.active_sort_fn)),e});var n=et(),w=S(n);{var B=e=>{var s=Z();C(s,()=>({...t.label_attrs,class:`p_xs row gap_xs2 mb_0 ${t.label_attrs?.class??""}`}));var f=L(j(s),2);q(f,21,()=>a.sorters,u=>u.key,(u,c)=>{var r=X(),d=j(r,!0);b(r);var g={};M(()=>{P(d,_(c).label),g!==(g=_(c).key)&&(r.value=(r.__value=_(c).key)??"")}),m(u,r)}),b(f),b(s),O(f,()=>a.active_key,u=>a.active_key=u),Q(3,s,()=>U),m(e,s)};A(w,e=>{l()&&a.sorters.length>1&&e(B)})}var D=L(w,2);{var F=e=>{var s=Y(),f=S(s);{var u=r=>{var d=Y(),g=S(d);{var H=E=>{var R=p(),I=j(R,!0);b(R),M(()=>P(I,v())),m(E,R)};A(g,E=>{v()&&E(H)})}m(r,d)},c=r=>{var d=Y(),g=S(d);T(g,v),m(r,d)};A(f,r=>{typeof v()=="string"?r(u):r(c,!1)})}m(e,s)},G=e=>{var s=tt();C(s,()=>({...t.list_attrs,class:`unstyled ${t.list_attrs?.class??""}`})),q(s,21,()=>_(o),f=>f.id,(f,u)=>{var c=$();C(c,()=>({...t.item_attrs}));var r=j(c);T(r,()=>t.children,()=>_(u)),b(c),m(f,c)}),b(s),m(e,s)};A(D,e=>{_(o).length===0?e(F):e(G,!1)})}m(k,n),N()}export{vt as S,nt as a,ct as s};
