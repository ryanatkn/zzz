import"./DsnmJJEf.js";import{y,x as o,z as h,L as I,p as J,f as x,a as S,b as m,c as K,s as M,d as z,r as b,t as P,e as R}from"./-CpFIzHZ.js";import{s as T,a as U}from"./DzZ7Rzvg.js";import{i as A}from"./DH5XRg4H.js";import{a as Y,e as j,d as N}from"./trDA34-_.js";import{t as O,s as Q}from"./D7AV01aJ.js";import{p as C}from"./Rk-Dv8br.js";import{E as V}from"./BEOpXXme.js";class W{#t;#e=y(()=>this.#t());get items(){return o(this.#e)}set items(t){h(this.#e,t)}#s;#r=y(()=>this.#s());get sorters(){return o(this.#r)}set sorters(t){h(this.#r,t)}#i;#a=y(()=>this.#i?.());get default_key(){return o(this.#a)}set default_key(t){h(this.#a,t)}#_=I("");get active_key(){return o(this.#_)}set active_key(t){h(this.#_,t,!0)}#o=y(()=>this.sorters.find(t=>t.key===this.active_key));get active_sorter(){return o(this.#o)}set active_sorter(t){h(this.#o,t)}#l=y(()=>this.active_sorter?.fn);get active_sort_fn(){return o(this.#l)}set active_sort_fn(t){h(this.#l,t)}#n=y(()=>{const t=[...this.items];return this.active_sort_fn?t.sort(this.active_sort_fn):t});get sorted_items(){return o(this.#n)}set sorted_items(t){h(this.#n,t)}constructor(t,a,r){this.#t=t,this.#s=a,this.#i=r,this.update_active_key()}update_active_key(){const t=this.sorters,a=this.default_key;if(!t.length){this.active_key="";return}if(a&&t.some(r=>r.key===a)){this.active_key=a;return}if(!t.some(r=>r.key===this.active_key)){const r=t[0];r?this.active_key=r.key:(console.error("Unexpected empty sorters array after length check"),this.active_key="")}}}const ct=(k,t,a,r="asc")=>{const f=r==="desc"?-1:1;return{key:k,label:t,fn:(_,l)=>{const n=f*String(_[a]).localeCompare(String(l[a]));return n!==0?n:l.cid-_.cid}}},ft=(k,t,a,r="asc")=>({key:k,label:t,fn:(f,_)=>{const l=f[a],n=_[a],w=r==="asc"?l<n?-1:l>n?1:0:l>n?-1:l<n?1:0;return w!==0?w:_.cid-f.cid}});var X=x("<option> </option>"),Z=x('<label><small class="pr_xs3 white_space_nowrap">sort by</small> <select class="compact plain font_size_sm"></select></label>'),p=x('<div class="p_md"> </div>'),$=x("<li><!></li>"),tt=x("<ul></ul>"),et=x("<!> <!>",1);function vt(k,t){J(t,!0);const a=C(t,"sorters",3,V),r=C(t,"show_sort_controls",3,!1),f=C(t,"no_items",3,"[no items available]"),_=new W(()=>t.items,()=>a(),()=>t.sort_key_default),l=y(()=>{if((!t.exclude_ids||t.exclude_ids.length===0)&&!t.filter&&!_.active_sort_fn)return t.items;let e=t.items;return t.exclude_ids&&t.exclude_ids.length>0&&(e=e.filter(s=>!t.exclude_ids.includes(s.id))),t.filter&&(e=e.filter(t.filter)),_.active_sort_fn&&(e===t.items&&(e=[...e]),e.sort(_.active_sort_fn)),e});var n=et(),w=S(n);{var q=e=>{var s=Z();Y(s,()=>({...t.label_attrs,class:`p_xs row gap_xs2 mb_0 ${t.label_attrs?.class??""}`}));var v=M(z(s),2);j(v,21,()=>_.sorters,u=>u.key,(u,c)=>{var i=X(),d=z(i,!0);b(i);var g={};P(()=>{T(d,o(c).label),g!==(g=o(c).key)&&(i.value=(i.__value=o(c).key)??"")}),m(u,i)}),b(v),b(s),N(v,()=>_.active_key,u=>_.active_key=u),O(3,s,()=>Q),m(e,s)};A(w,e=>{r()&&_.sorters.length>1&&e(q)})}var B=M(w,2);{var D=e=>{var s=R(),v=S(s);{var u=i=>{var d=R(),g=S(d);{var G=E=>{var L=p(),H=z(L,!0);b(L),P(()=>T(H,f())),m(E,L)};A(g,E=>{f()&&E(G)})}m(i,d)},c=i=>{var d=R(),g=S(d);U(g,f),m(i,d)};A(v,i=>{typeof f()=="string"?i(u):i(c,!1)})}m(e,s)},F=e=>{var s=tt();Y(s,()=>({...t.list_attrs,class:`unstyled ${t.list_attrs?.class??""}`})),j(s,21,()=>o(l),v=>v.id,(v,u)=>{var c=$();Y(c,()=>({...t.item_attrs}));var i=z(c);U(i,()=>t.children,()=>o(u)),b(c),m(v,c)}),b(s),m(e,s)};A(B,e=>{o(l).length===0?e(D):e(F,!1)})}m(k,n),K()}export{vt as S,ct as a,ft as s};
