import"./DsnmJJEf.js";import{p as Le,f as y,d as r,s as f,i as t,j as J,r as n,t as C,b as d,c as Xe,h as A,k as be,l as U,e as Ie,a as ie,n as ce}from"./DsYFF3e0.js";import{d as Fe,s as V,b as He}from"./D6t6EFf3.js";import{i as M,p as je}from"./Nwe5dM3j.js";import{h as oe,V as Ee,W as Te,j as Ge,R as Oe,m as Ne,s as Se,r as Re,t as Ce,d as Ve}from"./dRtQjgBD.js";import{t as ye,s as xe}from"./R2QwTmpq.js";import{P as Me}from"./4X2iJCGk.js";import{M as Ue}from"./B4cFFwNA.js";import{a as Be}from"./DM4ztRtC.js";import{x as K,y as De,z as Ye,B as We,F as qe,G as Ae,I as ve}from"./z7712QSE.js";import{b as Je}from"./CNYcfd7V.js";import{f as Ke}from"./ChYHAxKB.js";import{P as Qe}from"./CEnclk0t.js";import{E as Ze}from"./BBNa1a7U.js";import{E as ke}from"./BeRhWz1w.js";function ue(i,e){const s=+K(i)-+K(e);return s<0?-1:s>0?1:s}function $e(i,e,s){const[l,a]=De(s?.in,i,e),c=l.getFullYear()-a.getFullYear(),u=l.getMonth()-a.getMonth();return c*12+u}function ea(i){return e=>{const l=(i?Math[i]:Math.trunc)(e);return l===0?0:l}}function aa(i,e){return+K(i)-+K(e)}function ta(i,e){const s=K(i,e?.in);return s.setHours(23,59,59,999),s}function sa(i,e){const s=K(i,e?.in),l=s.getMonth();return s.setFullYear(s.getFullYear(),l+1,0),s.setHours(23,59,59,999),s}function na(i,e){const s=K(i,e?.in);return+ta(s,e)==+sa(s,e)}function ra(i,e,s){const[l,a,c]=De(s?.in,i,i,e),u=ue(a,c),o=Math.abs($e(a,c));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-u*o);let g=ue(a,c)===-u;na(l)&&o===1&&ue(l,c)===1&&(g=!1);const h=u*(o-+g);return h===0?0:h}function ia(i,e,s){const l=aa(i,e)/1e3;return ea(s?.roundingMethod)(l)}function oa(i,e,s){const l=We(),a=s?.locale??l.locale??qe,c=2520,u=ue(i,e);if(isNaN(u))throw new RangeError("Invalid time value");const o=Object.assign({},s,{addSuffix:s?.addSuffix,comparison:u}),[g,h]=De(s?.in,...u>0?[e,i]:[i,e]),D=ia(h,g),B=(Ye(h)-Ye(g))/1e3,m=Math.round((D-B)/60);let O;if(m<2)return s?.includeSeconds?D<5?a.formatDistance("lessThanXSeconds",5,o):D<10?a.formatDistance("lessThanXSeconds",10,o):D<20?a.formatDistance("lessThanXSeconds",20,o):D<40?a.formatDistance("halfAMinute",0,o):D<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):m===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",m,o);if(m<45)return a.formatDistance("xMinutes",m,o);if(m<90)return a.formatDistance("aboutXHours",1,o);if(m<Ae){const v=Math.round(m/60);return a.formatDistance("aboutXHours",v,o)}else{if(m<c)return a.formatDistance("xDays",1,o);if(m<ve){const v=Math.round(m/Ae);return a.formatDistance("xDays",v,o)}else if(m<ve*2)return O=Math.round(m/ve),a.formatDistance("aboutXMonths",O,o)}if(O=ra(h,g),O<12){const v=Math.round(m/ve);return a.formatDistance("xMonths",v,o)}else{const v=O%12,p=Math.trunc(O/12);return v<3?a.formatDistance("aboutXYears",p,o):v<9?a.formatDistance("overXYears",p,o):a.formatDistance("almostXYears",p+1,o)}}var la=(i,e)=>{e.ollama.ps_polling_enabled?e.ollama.stop_ps_polling():e.ollama.start_ps_polling()},_a=y('<div class="display_flex justify_content_space_between align_items_center p_sm border_radius_xs bg_1"><div class="display_flex gap_sm align_items_center"><!> <span> </span></div></div>'),da=(i,e,s)=>e.ollama.select(e.ollama.model_by_name.get(t(s).name)),ca=y("<small> </small>"),va=y("<small><!></small>"),ua=(i,e,s)=>e.ollama.unload(t(s).name),fa=y('<div class="display_flex justify_content_space_between align_items_center p_sm border_radius_xs bg_1"><div class="display_flex gap_sm align_items_center"><button type="button" class="icon_button plain" title="view model details"><!></button> <!> <!></div> <div class="display_flex gap_sm align_items_center"><!> <button type="button" class="icon_button plain" title="unload model from memory"><!></button></div></div>'),ma=y('<li class="py_xs3"><!></li>'),pa=y('<ul class="unstyled"></ul>'),ga=y('<p class="font_size_sm">no models currently loaded</p>'),ha=y('<div class="panel p_md width_upto_md"><div class="display_flex justify_content_space_between align_items_center mb_md"><h4 class="mt_0 mb_0">active models</h4> <div class="display_flex align_items_center gap_sm"><!> <button type="button" class="plain align_items_center gap_sm" title="polls Ollama continuously for the status of running models"><!> <span> </span></button></div></div> <!></div>');function Va(i,e){Le(e,!0);var s=ha(),l=r(s),a=f(r(l),2),c=r(a);{var u=v=>{Me(v,{})};M(c,v=>{e.ollama.ps_status==="pending"&&v(u)})}var o=f(c,2);o.__click=[la,e];var g=r(o);{let v=J(()=>e.ollama.ps_polling_enabled?Ee:Te);oe(g,{get glyph(){return t(v)}})}var h=f(g,2),D=r(h);n(h),n(o),n(a),n(l);var B=f(l,2);{var m=v=>{var p=pa();Ge(p,21,()=>e.ollama.running_models,w=>w.name,(w,x)=>{const S=J(()=>e.ollama.model_by_name.get(t(x).name));var j=ma(),L=r(j);{var W=E=>{var X=_a(),F=r(X),z=r(F);oe(z,{get glyph(){return Oe}});var Q=f(z,2),Z=r(Q);n(Q),n(F),n(X),C(()=>V(Z,`model ${t(x).name??""} not found`)),d(E,X)},le=E=>{var X=fa(),F=r(X),z=r(F);z.__click=[da,e,x];var Q=r(z);oe(Q,{get glyph(){return Oe}}),n(z);var Z=f(z,2);Ue(Z,{get model(){return t(S)}});var _e=f(Z,2);{var $=P=>{var H=ca(),ee=r(H);n(H),C(q=>V(ee,`VRAM: ${q??""}`),[()=>Be(t(x).size_vram)]),d(P,H)};M(_e,P=>{t(x).size_vram>0&&P($)})}n(F);var se=f(F,2),T=r(se);{var fe=P=>{const H=J(()=>new Date(t(x).expires_at)),ee=J(()=>t(H).valueOf());var q=va(),pe=r(q);{var _=k=>{var G=A();C(ae=>V(G,`expires ${ae??""}`),[()=>oa(t(H),e.ollama.app.time.now_ms,{addSuffix:!0})]),d(k,G)},b=k=>{var G=A("expired");d(k,G)};M(pe,k=>{t(ee)>e.ollama.app.time.now_ms?k(_):k(b,!1)})}n(q),d(P,q)};M(T,P=>{t(x).expires_at&&P(fe)})}var ne=f(T,2);ne.__click=[ua,e,x];var me=r(ne);oe(me,{get glyph(){return Ne}}),n(ne),n(se),n(X),d(E,X)};M(L,E=>{t(S)?E(le,!1):E(W)})}n(j),ye(3,j,()=>xe),d(w,j)}),n(p),ye(3,p,()=>xe),d(v,p)},O=v=>{var p=ga();ye(3,p,()=>xe),d(v,p)};M(B,v=>{e.ollama.running_models.length>0?v(m):v(O,!1)})}n(s),C(()=>{o.disabled=e.ollama.ps_status==="pending",V(D,`${e.ollama.ps_polling_enabled?"stop":"start"} monitoring`)}),d(i,s),Xe()}Fe(["click"]);const ba=async(i,e,s,l,a,c)=>{if(t(e)){U(s,!0);try{await l.api.provider_update_api_key({provider_name:a.provider_name,api_key:t(e)}),U(c,"")}catch(u){console.error(`Failed to update ${a.provider_name} API key:`,u)}finally{U(s,!1)}}},ya=async(i,e,s,l)=>{U(e,!0);try{await s.api.provider_update_api_key({provider_name:l.provider_name,api_key:""})}catch(a){console.error(`Failed to delete ${l.provider_name} API key:`,a)}finally{U(e,!1)}},xa=async(i,e,s,l)=>{U(e,!0);try{await s.api.provider_load_status({provider_name:l.provider_name})}catch(a){console.error(`Failed to check ${l.provider_name} connection:`,a)}finally{U(e,!1)}};var ka=y("updating <!>",1),Ma=y('<span class="white_space_nowrap"><!> </span> provider',1),Da=y("<div><!></div> <ul><li><!></li> <li><!></li> <li><!></li></ul>",1),wa=y('<div class="py_sm display_flex gap_sm align_items_start"><form class="flex_1"><div><div class="column justify_content_center gap_xs pl_md"><div class="font_size_xl"> <!></div> <span class="font_family_mono font_size_sm"><!></span></div></div> <fieldset><input type="password" placeholder="enter new API key" class="mb_sm"/> <div class="display_flex justify_content_space_between gap_xs"><button type="button" class="flex_1"><!></button> <button type="button" class="flex_1">reload</button> <button type="button" class="flex_1">delete key</button></div></fieldset></form> <div class="flex_1"><!></div></div>'),Pa=y('<small class="font_family_mono"> </small>'),Ia=y('<div class="py_sm"><!></div>'),Oa=y('<div class="display_flex flex_direction_column"><!></div>');function Ua(i,e){Le(e,!0);const s=je(e,"show_info",3,!0),l=Ke.get(),{capabilities:a}=l,c=J(()=>a[e.provider_name]),u=J(()=>l.providers.find_by_name(e.provider_name));let o=be(""),g=be(!1),h=be(!1);const D=J(()=>t(o).trim());He(()=>{a[`init_${e.provider_name}_check`]()});var B=Oa(),m=r(B);{var O=p=>{var w=wa(),x=r(w),S=r(x);let j;Se(S,"",{},{display:"display_flex !important","align-items":"flex-start !important","font-weight":"400 !important"});var L=r(S);Se(L,"",{},{"min-height":"80px"});var W=r(L),le=r(W),E=f(le);{var X=_=>{Me(_,{inline:!0})};M(E,_=>{(t(c).status==="pending"||t(h))&&_(X)})}n(W);var F=f(W,2),z=r(F);{var Q=_=>{var b=A();C(()=>V(b,t(c).error_message)),d(_,b)},Z=_=>{var b=Ie(),k=ie(b);{var G=Y=>{var te=A("available");d(Y,te)},ae=Y=>{var te=Ie(),re=ie(te);{var ge=N=>{var I=A("backend unavailable");d(N,I)},de=N=>{var I=A("Â ");d(N,I)};M(re,N=>{a.backend_available?N(de,!1):N(ge)},!0)}d(Y,te)};M(k,Y=>{t(c).status==="success"?Y(G):Y(ae,!1)},!0)}d(_,b)};M(z,_=>{t(c).error_message?_(Q):_(Z,!1)})}n(F),n(L),n(S);var _e=f(S,2),$=r(_e);Re($);var se=f($,2),T=r(se);T.__click=[ba,D,g,l,e,o];var fe=r(T);{var ne=_=>{var b=ka(),k=f(ie(b));Me(k,{inline:!0}),d(_,b)},me=_=>{var b=A("update key");d(_,b)};M(fe,_=>{t(g)?_(ne):_(me,!1)})}n(T);var P=f(T,2);P.__click=[xa,h,l,e];var H=f(P,2);H.__click=[ya,g,l,e],n(se),n(_e),n(x);var ee=f(x,2),q=r(ee);{var pe=_=>{var b=Da(),k=ie(b),G=r(k);Qe(G,{get provider(){return t(u)},children:(I,he)=>{var R=Ma(),we=ie(R),Pe=r(we);oe(Pe,{get glyph(){return Ve}});var ze=f(Pe);n(we),ce(),C(()=>V(ze,` ${t(u).title??""}`)),d(I,R)},$$slots:{default:!0}}),n(k);var ae=f(k,2),Y=r(ae),te=r(Y);ke(te,{get href(){return t(u).api_key_url},children:(I,he)=>{ce();var R=A("get API key");d(I,R)},$$slots:{default:!0}}),n(Y);var re=f(Y,2),ge=r(re);ke(ge,{get href(){return t(u).homepage},children:(I,he)=>{ce();var R=A("homepage");d(I,R)},$$slots:{default:!0}}),n(re);var de=f(re,2),N=r(de);ke(N,{get href(){return t(u).url},children:(I,he)=>{ce();var R=A("docs");d(I,R)},$$slots:{default:!0}}),n(de),n(ae),d(_,b)};M(q,_=>{s()&&_(pe)})}n(ee),n(w),C(_=>{j=Ce(S,1,"width_100 chip plain flex_1 flex_direction_column mb_lg",null,j,_),V(le,`${t(u).name??""}
							${t(c).status==="success"?"configured":t(c).status==="failure"?"not configured":t(c).status==="pending"||t(h)?"checking":"not checked"} `),$.disabled=t(g)||!a.backend_available,T.disabled=!t(D)||t(g)||!a.backend_available,P.disabled=t(h)||t(g)||!a.backend_available,H.disabled=t(c).status!=="success"||t(g)||!a.backend_available},[()=>({color_b:t(c).status==="success",color_c:t(c).status==="failure",color_d:t(c).status==="pending"||t(h),color_e:t(c).status==="initial"})]),Je($,()=>t(o),_=>U(o,_)),d(p,w)},v=p=>{var w=Ia(),x=r(w);Ze(x,{children:(S,j)=>{var L=Pa(),W=r(L);n(L),C(()=>V(W,`provider "${e.provider_name??""}" not found`)),d(S,L)},$$slots:{default:!0}}),n(w),d(p,w)};M(m,p=>{t(u)?p(O):p(v,!1)})}n(B),d(i,B),Xe()}Fe(["click"]);export{Ua as C,Va as O,ra as a,ia as b,ue as c,aa as d,ea as g};
