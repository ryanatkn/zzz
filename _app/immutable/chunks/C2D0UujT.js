import"./DsnmJJEf.js";import{p as H,f as h,a as w,s as b,a2 as j,b as n,c as R,d as z,r as A,t as $,e as G,n as ce,h as fe,x as i,y as E}from"./-CpFIzHZ.js";import{p as D,s as q,r as ee}from"./Rk-Dv8br.js";import{i as g}from"./DH5XRg4H.js";import{D as ue}from"./B3Tu39mr.js";import{s as te,a as se}from"./DzZ7Rzvg.js";import{E as _e}from"./DHmKwG-o.js";import{S as ve,a as W,s as P}from"./Dh_Ly8-d.js";import{f as re}from"./CtVB41cF.js";import{a as me,C as ge}from"./trDA34-_.js";import{s as X}from"./V2q5a4YM.js";import{C as he,a as ke,b as Z}from"./CCs77x1m.js";import{C as I}from"./DNrAa8_K.js";import{i as C,b as O,o as ye,x as be}from"./CIQxfFOX.js";var we=h('<h2 class="mt_lg text_align_center"> </h2>'),xe=h("<!> <!>",1);function pe(v,e){H(e,!0);const l=D(e,"sorters",3,_e),m=D(e,"show_sort_controls",3,!1),_=D(e,"heading",3,null),o=t=>{e.onpick(t)};var c=xe(),r=w(c);{var f=t=>{var u=we(),k=z(u,!0);A(u),$(()=>te(k,_())),n(t,u)};g(r,t=>{_()&&t(f)})}var a=b(r,2);ve(a,{get items(){return e.items},get filter(){return e.filter},get exclude_ids(){return e.exclude_ids},get sorters(){return l()},get sort_key_default(){return e.sort_key_default},get show_sort_controls(){return m()},get no_items(){return e.no_items},children:(u,k=j)=>{var y=G(),x=w(y);se(x,()=>e.children,k,()=>o),n(u,y)},$$slots:{default:!0}}),n(v,c),R()}var Pe=h('<div class="pane p_lg width_upto_md mx_auto"><!></div>');function Ce(v,e){H(e,!0);let l=D(e,"show",15,!1),m=ee(e,["$$slots","$$events","$$legacy","onpick","show","dialog_props"]);var _=G(),o=w(_);{var c=r=>{ue(r,q(()=>e.dialog_props,{onclose:()=>{e.onpick(void 0),l(!1)},children:(f,a)=>{var t=Pe(),u=z(t);pe(u,q(()=>m,{onpick:k=>{e.onpick(k)!==!1&&l(!1)}})),A(t),n(f,t)},$$slots:{default:!0}}))};g(o,r=>{l()&&r(c)})}n(v,_),R()}var Ee=h("<span>select tab</span>"),De=h("<span>preview tab</span>"),Le=h("<span>close tab</span>"),Se=h("<span>delete file</span>"),Ye=h("<!> <!> <!> <!> <!> <!>",1);function ze(v,e){H(e,!0);const l=a=>{var t=G(),u=w(t);{var k=y=>{const x=E(()=>{const{diskfiles:T}=e.diskfile.app;return{diskfiles:T}}),B=E(()=>{const{tabs:T}=i(x).diskfiles.editor;return{tabs:T}}),L=E(()=>i(B).tabs.by_diskfile_id.get(e.diskfile.id)),J=E(()=>e.diskfile===i(B).tabs.selected_tab?.diskfile);ke(y,{icon:S=>{C(S,{get glyph(){return O}})},menu:S=>{var V=Ye(),M=w(V);{var ae=s=>{I(s,{run:()=>{i(x).diskfiles.select(e.diskfile.id,!0)},icon:d=>{C(d,{get glyph(){return O}})},children:(d,F)=>{var Y=Ee();n(d,Y)},$$slots:{icon:!0,default:!0}})};g(M,s=>{(!i(J)||i(L)?.is_preview)&&s(ae)})}var K=b(M,2);{var ie=s=>{I(s,{run:()=>{i(x).diskfiles.select(e.diskfile.id,!1)},icon:d=>{C(d,{get glyph(){return O}})},children:(d,F)=>{var Y=De();n(d,Y)},$$slots:{icon:!0,default:!0}})};g(K,s=>{(!i(L)||!i(J)&&i(L).is_preview)&&s(ie)})}var N=b(K,2);{var ne=s=>{I(s,{run:()=>{i(x).diskfiles.editor.close_tab(i(L).id)},icon:d=>{C(d,{get glyph(){return be}})},children:(d,F)=>{var Y=Le();n(d,Y)},$$slots:{icon:!0,default:!0}})};g(N,s=>{i(L)&&s(ne)})}var Q=b(N,2);{var le=s=>{Z(s,{get content(){return e.diskfile.path_relative},label:"copy file path"})};g(Q,s=>{e.diskfile.path_relative&&s(le)})}var U=b(Q,2);{var oe=s=>{Z(s,{get content(){return e.diskfile.content},label:"copy file content",get preview(){return e.diskfile.content_preview}})};g(U,s=>{e.diskfile.content&&s(oe)})}var de=b(U,2);I(de,{run:async()=>{confirm(`Are you sure you want to delete ${e.diskfile.path_relative}?`)&&await _.diskfiles.delete(e.diskfile.path)},icon:p=>{C(p,{get glyph(){return ye}})},children:(p,d)=>{var F=Se();n(p,F)},$$slots:{icon:!0,default:!0}}),n(S,V)},children:(S,V)=>{ce();var M=fe("file");n(S,M)},$$slots:{icon:!0,menu:!0,default:!0}})};g(u,y=>{e.diskfile&&y(k)})}n(a,t)},m=ee(e,["$$slots","$$events","$$legacy","diskfile","children"]),_=re.get();var o=G(),c=w(o);{var r=a=>{he(a,q(()=>m,{get entries(){return l},get children(){return e.children}}))},f=a=>{var t=G(),u=w(t);se(u,()=>e.children),n(a,t)};g(c,a=>{e.diskfile?a(r):a(f,!1)})}n(v,o),R()}var Ae=h('<div><small class="ellipsis"><!> <span class="ml_xs"> </span></small></div>');function Ge(v,e){H(e,!0);const l=D(e,"selected",3,!1);ze(v,{get diskfile(){return e.diskfile},children:(m,_)=>{var o=Ae();me(o,()=>({role:"button",tabindex:"0",class:"menu_item compact ellipsis cursor_pointer",...e.attrs,onclick:e.onselect?t=>{X(t),e.onselect(e.diskfile,t.detail===2)}:void 0,onkeydown:e.onselect?t=>{(t.key==="Enter"||t.key===" ")&&(X(t),e.onselect(e.diskfile,!0))}:void 0,"aria-label":e.diskfile.path_relative??void 0,"aria-pressed":l(),[ge]:{selected:l()}}));var c=z(o),r=z(c);C(r,{get glyph(){return O}});var f=b(r,2),a=z(f,!0);A(f),A(c),A(o),$(()=>te(a,e.diskfile.path_relative)),n(m,o)},$$slots:{default:!0}}),R()}function Ue(v,e){H(e,!0);let l=D(e,"show",15,!1);const m=re.get(),{diskfiles:_}=m;{const o=(r,f=j,a=j)=>{{let t=E(()=>!!e.selected_ids&&e.selected_ids.includes(f().id));Ge(r,{get diskfile(){return f()},get selected(){return i(t)},get onselect(){return a()}})}};let c=E(()=>[W("path_asc","path (a-z)","path"),W("path_desc","path (z-a)","path","desc"),P("created_newest","newest first","created_date","desc"),P("created_oldest","oldest first","created_date","asc"),P("updated_recently","recently updated","updated_date","desc"),P("updated_oldest","least recently updated","updated_date","asc"),P("font_size_largest","largest first","content_length","desc"),P("font_size_smallest","smallest first","content_length","asc")]);Ce(v,{get items(){return _.items.values},get onpick(){return e.onpick},get filter(){return e.filter},get exclude_ids(){return e.exclude_ids},get dialog_props(){return e.dialog_props},get sorters(){return i(c)},sort_key_default:"path_asc",show_sort_controls:!0,heading:"Pick a file",get show(){return l()},set show(r){l(r)},children:o,$$slots:{default:!0}})}R()}export{Ue as D,Ce as P,Ge as a,ze as b,pe as c};
