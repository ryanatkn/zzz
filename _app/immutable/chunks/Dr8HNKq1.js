import"./DsnmJJEf.js";import{p as He,f as y,d as n,s as v,x as a,y as J,r as s,t as C,b as _,c as Fe,h as L,L as ke,z as N,e as Ye,a as ie,n as ve}from"./-CpFIzHZ.js";import{s as R,d as Ee,f as je}from"./DzZ7Rzvg.js";import{i as D}from"./DH5XRg4H.js";import{e as Ge,b as Le,r as Ne,c as Ce}from"./trDA34-_.js";import{t as Me,s as De}from"./D7AV01aJ.js";import{P as Pe}from"./DNrAa8_K.js";import{i as oe,H as Re,I as Ue,f as Ae,l as Ve,d as qe}from"./CIQxfFOX.js";import{M as Be}from"./_rBCeTRV.js";import{a as Je}from"./DM4ztRtC.js";import{i as K,n as Ie,j as Xe,k as Ke,l as Qe,m as ze,o as fe}from"./DHmKwG-o.js";import{b as We}from"./DUXOEpA9.js";import{p as Ze}from"./Rk-Dv8br.js";import{f as $e}from"./CtVB41cF.js";import{P as ea}from"./DN4aWqQ0.js";import{E as aa}from"./ZMi9mf8B.js";import{E as we}from"./BORMFxyC.js";function me(l,e){const r=+K(l)-+K(e);return r<0?-1:r>0?1:r}function ta(l,e,r){const[c,t]=Ie(r?.in,l,e),u=c.getFullYear()-t.getFullYear(),f=c.getMonth()-t.getMonth();return u*12+f}function sa(l){return e=>{const c=(l?Math[l]:Math.trunc)(e);return c===0?0:c}}function na(l,e){return+K(l)-+K(e)}function ra(l,e){const r=K(l,e?.in);return r.setHours(23,59,59,999),r}function ia(l,e){const r=K(l,e?.in),c=r.getMonth();return r.setFullYear(r.getFullYear(),c+1,0),r.setHours(23,59,59,999),r}function oa(l,e){const r=K(l,e?.in);return+ra(r,e)==+ia(r,e)}function la(l,e,r){const[c,t,u]=Ie(r?.in,l,l,e),f=me(t,u),i=Math.abs(ta(t,u));if(i<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-f*i);let m=me(t,u)===-f;oa(c)&&i===1&&me(c,u)===1&&(m=!1);const g=f*(i-+m);return g===0?0:g}function _a(l,e,r){const c=na(l,e)/1e3;return sa(r?.roundingMethod)(c)}function da(l,e,r){const c=Ke(),t=r?.locale??c.locale??Qe,u=2520,f=me(l,e);if(isNaN(f))throw new RangeError("Invalid time value");const i=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:f}),[m,g]=Ie(r?.in,...f>0?[e,l]:[l,e]),w=_a(g,m),ee=(Xe(g)-Xe(m))/1e3,p=Math.round((w-ee)/60);let O;if(p<2)return r?.includeSeconds?w<5?t.formatDistance("lessThanXSeconds",5,i):w<10?t.formatDistance("lessThanXSeconds",10,i):w<20?t.formatDistance("lessThanXSeconds",20,i):w<40?t.formatDistance("halfAMinute",0,i):w<60?t.formatDistance("lessThanXMinutes",1,i):t.formatDistance("xMinutes",1,i):p===0?t.formatDistance("lessThanXMinutes",1,i):t.formatDistance("xMinutes",p,i);if(p<45)return t.formatDistance("xMinutes",p,i);if(p<90)return t.formatDistance("aboutXHours",1,i);if(p<ze){const d=Math.round(p/60);return t.formatDistance("aboutXHours",d,i)}else{if(p<u)return t.formatDistance("xDays",1,i);if(p<fe){const d=Math.round(p/ze);return t.formatDistance("xDays",d,i)}else if(p<fe*2)return O=Math.round(p/fe),t.formatDistance("aboutXMonths",O,i)}if(O=la(g,m),O<12){const d=Math.round(p/fe);return t.formatDistance("xMonths",d,i)}else{const d=O%12,k=Math.trunc(O/12);return d<3?t.formatDistance("aboutXYears",k,i):d<9?t.formatDistance("overXYears",k,i):t.formatDistance("almostXYears",k+1,i)}}var ca=y('<div class="display_flex justify_content_space_between align_items_center p_sm border_radius_xs bg_1"><div class="display_flex gap_sm align_items_center"><!> <span> </span></div></div>'),ua=y("<small> </small>"),va=y("<small><!></small>"),fa=y('<div class="display_flex justify_content_space_between align_items_center p_sm border_radius_xs bg_1"><div class="display_flex gap_sm align_items_center"><button type="button" class="icon_button plain" title="view model details"><!></button> <!> <!></div> <div class="display_flex gap_sm align_items_center"><!> <button type="button" class="icon_button plain" title="unload model from memory"><!></button></div></div>'),ma=y('<li class="py_xs3"><!></li>'),pa=y('<ul class="unstyled"></ul>'),ga=y('<p class="font_size_sm">no models currently loaded</p>'),ha=y('<div class="panel p_md width_upto_md"><div class="display_flex justify_content_space_between align_items_center mb_md"><h4 class="mt_0 mb_0">active models</h4> <div class="display_flex align_items_center gap_sm"><!> <button type="button" class="plain align_items_center gap_sm" title="polls Ollama continuously for the status of running models"><!> <span> </span></button></div></div> <!></div>');function Ra(l,e){He(e,!0);var r=ha(),c=n(r),t=v(n(c),2),u=n(t);{var f=d=>{Pe(d,{})};D(u,d=>{e.ollama.ps_status==="pending"&&d(f)})}var i=v(u,2);i.__click=()=>{e.ollama.ps_polling_enabled?e.ollama.stop_ps_polling():e.ollama.start_ps_polling()};var m=n(i);{let d=J(()=>e.ollama.ps_polling_enabled?Re:Ue);oe(m,{get glyph(){return a(d)}})}var g=v(m,2),w=n(g);s(g),s(i),s(t),s(c);var ee=v(c,2);{var p=d=>{var k=pa();Ge(k,21,()=>e.ollama.running_models,ae=>ae.name,(ae,S)=>{const h=J(()=>e.ollama.model_by_name.get(a(S).name));var P=ma(),U=n(P);{var A=x=>{var M=ca(),X=n(M),z=n(X);oe(z,{get glyph(){return Ae}});var Q=v(z,2),V=n(Q);s(Q),s(X),s(M),C(()=>R(V,`model ${a(S).name??""} not found`)),_(x,M)},te=x=>{var M=fa(),X=n(M),z=n(X);z.__click=()=>e.ollama.select(e.ollama.model_by_name.get(a(S).name));var Q=n(z);oe(Q,{get glyph(){return Ae}}),s(z);var V=v(z,2);Be(V,{get model(){return a(h)}});var pe=v(V,2);{var ge=H=>{var E=ua(),ne=n(E);s(E),C(F=>R(ne,`VRAM: ${F??""}`),[()=>Je(a(S).size_vram)]),_(H,E)};D(pe,H=>{a(S).size_vram>0&&H(ge)})}s(X);var le=v(X,2),se=n(le);{var W=H=>{const E=J(()=>new Date(a(S).expires_at)),ne=J(()=>a(E).valueOf());var F=va(),_e=n(F);{var de=T=>{var o=L();C(b=>R(o,`expires ${b??""}`),[()=>da(a(E),e.ollama.app.time.now_ms,{addSuffix:!0})]),_(T,o)},he=T=>{var o=L("expired");_(T,o)};D(_e,T=>{a(ne)>e.ollama.app.time.now_ms?T(de):T(he,!1)})}s(F),_(H,F)};D(se,H=>{a(S).expires_at&&H(W)})}var Z=v(se,2);Z.__click=()=>e.ollama.unload(a(S).name);var q=n(Z);oe(q,{get glyph(){return Ve}}),s(Z),s(le),s(M),_(x,M)};D(U,x=>{a(h)?x(te,!1):x(A)})}s(P),Me(3,P,()=>De),_(ae,P)}),s(k),Me(3,k,()=>De),_(d,k)},O=d=>{var k=ga();Me(3,k,()=>De),_(d,k)};D(ee,d=>{e.ollama.running_models.length>0?d(p):d(O,!1)})}s(r),C(()=>{i.disabled=e.ollama.ps_status==="pending",R(w,`${e.ollama.ps_polling_enabled?"stop":"start"} monitoring`)}),_(l,r),Fe()}Ee(["click"]);var ba=y("updating <!>",1),ya=y('<span class="white_space_nowrap"><!> </span> provider',1),xa=y("<div><!></div> <ul><li><!></li> <li><!></li> <li><!></li></ul>",1),ka=y('<div class="py_sm display_flex gap_sm align_items_start"><form class="flex_1"><div><div class="column justify_content_center gap_xs pl_md"><div class="font_size_xl"> <!></div> <span class="font_family_mono font_size_sm"><!></span></div></div> <fieldset><input type="password" placeholder="enter new API key" class="mb_sm"/> <div class="display_flex justify_content_space_between gap_xs"><button type="button" class="flex_1"><!></button> <button type="button" class="flex_1">reload</button> <button type="button" class="flex_1">delete key</button></div></fieldset></form> <div class="flex_1"><!></div></div>'),Ma=y('<small class="font_family_mono"> </small>'),Da=y('<div class="py_sm"><!></div>'),wa=y('<div class="display_flex flex_direction_column"><!></div>');function Ua(l,e){He(e,!0);const r=Ze(e,"show_info",3,!0),c=$e.get(),{capabilities:t}=c,u=J(()=>t[e.provider_name]),f=J(()=>c.providers.find_by_name(e.provider_name));let i=ke(""),m=ke(!1),g=ke(!1);const w=J(()=>a(i).trim());je(()=>{t[`init_${e.provider_name}_check`]()});const ee=async()=>{if(a(w)){N(m,!0);try{await c.api.provider_update_api_key({provider_name:e.provider_name,api_key:a(w)}),N(i,"")}catch(h){console.error(`Failed to update ${e.provider_name} API key:`,h)}finally{N(m,!1)}}},p=async()=>{N(m,!0);try{await c.api.provider_update_api_key({provider_name:e.provider_name,api_key:""})}catch(h){console.error(`Failed to delete ${e.provider_name} API key:`,h)}finally{N(m,!1)}},O=async()=>{N(g,!0);try{await c.api.provider_load_status({provider_name:e.provider_name})}catch(h){console.error(`Failed to check ${e.provider_name} connection:`,h)}finally{N(g,!1)}};var d=wa(),k=n(d);{var ae=h=>{var P=ka(),U=n(P),A=n(U);let te;Le(A,"",{},{display:"display_flex !important","align-items":"flex-start !important","font-weight":"400 !important"});var x=n(A);Le(x,"",{},{"min-height":"80px"});var M=n(x),X=n(M),z=v(X);{var Q=o=>{Pe(o,{inline:!0})};D(z,o=>{(a(u).status==="pending"||a(g))&&o(Q)})}s(M);var V=v(M,2),pe=n(V);{var ge=o=>{var b=L();C(()=>R(b,a(u).error_message)),_(o,b)},le=o=>{var b=Ye(),B=ie(b);{var be=Y=>{var $=L("available");_(Y,$)},ce=Y=>{var $=Ye(),re=ie($);{var ye=j=>{var I=L("backend unavailable");_(j,I)},ue=j=>{var I=L("Â ");_(j,I)};D(re,j=>{t.backend_available?j(ue,!1):j(ye)},!0)}_(Y,$)};D(B,Y=>{a(u).status==="success"?Y(be):Y(ce,!1)},!0)}_(o,b)};D(pe,o=>{a(u).error_message?o(ge):o(le,!1)})}s(V),s(x),s(A);var se=v(A,2),W=n(se);Ne(W);var Z=v(W,2),q=n(Z);q.__click=ee;var H=n(q);{var E=o=>{var b=ba(),B=v(ie(b));Pe(B,{inline:!0}),_(o,b)},ne=o=>{var b=L("update key");_(o,b)};D(H,o=>{a(m)?o(E):o(ne,!1)})}s(q);var F=v(q,2);F.__click=O;var _e=v(F,2);_e.__click=p,s(Z),s(se),s(U);var de=v(U,2),he=n(de);{var T=o=>{var b=xa(),B=ie(b),be=n(B);ea(be,{get provider(){return a(f)},children:(I,xe)=>{var G=ya(),Oe=ie(G),Se=n(Oe);oe(Se,{get glyph(){return qe}});var Te=v(Se);s(Oe),ve(),C(()=>R(Te,` ${a(f).title??""}`)),_(I,G)},$$slots:{default:!0}}),s(B);var ce=v(B,2),Y=n(ce),$=n(Y);we($,{get href(){return a(f).api_key_url},children:(I,xe)=>{ve();var G=L("get API key");_(I,G)},$$slots:{default:!0}}),s(Y);var re=v(Y,2),ye=n(re);we(ye,{get href(){return a(f).homepage},children:(I,xe)=>{ve();var G=L("homepage");_(I,G)},$$slots:{default:!0}}),s(re);var ue=v(re,2),j=n(ue);we(j,{get href(){return a(f).url},children:(I,xe)=>{ve();var G=L("docs");_(I,G)},$$slots:{default:!0}}),s(ue),s(ce),_(o,b)};D(he,o=>{r()&&o(T)})}s(de),s(P),C(()=>{te=Ce(A,1,"width_100 chip plain flex_1 flex_direction_column mb_lg",null,te,{color_b:a(u).status==="success",color_c:a(u).status==="failure",color_d:a(u).status==="pending"||a(g),color_e:a(u).status==="initial"}),R(X,`${a(f).name??""}
							${a(u).status==="success"?"configured":a(u).status==="failure"?"not configured":a(u).status==="pending"||a(g)?"checking":"not checked"} `),W.disabled=a(m)||!t.backend_available,q.disabled=!a(w)||a(m)||!t.backend_available,F.disabled=a(g)||a(m)||!t.backend_available,_e.disabled=a(u).status!=="success"||a(m)||!t.backend_available}),We(W,()=>a(i),o=>N(i,o)),_(h,P)},S=h=>{var P=Da(),U=n(P);aa(U,{children:(A,te)=>{var x=Ma(),M=n(x);s(x),C(()=>R(M,`provider "${e.provider_name??""}" not found`)),_(A,x)},$$slots:{default:!0}}),s(P),_(h,P)};D(k,h=>{a(f)?h(ae):h(S,!1)})}s(d),_(l,d),Fe()}Ee(["click"]);export{Ua as C,Ra as O,la as a,_a as b,me as c,na as d,sa as g};
