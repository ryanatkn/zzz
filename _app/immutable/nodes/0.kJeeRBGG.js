import"../chunks/DsnmJJEf.js";import{a as Y,s as de,e as G,d as je,f as tt}from"../chunks/pja_h9dl.js";import{B as Be,F as at,u as ot,p as ae,e as k,a as f,x as a,y as P,b as s,c as oe,n as Me,h as Ne,t as B,f as O,$ as q,ap as te,s as H,I as j,z as i,d as D,r as E,bn as rt,g as st,a1 as Re}from"../chunks/vp8LXHGR.js";import{p as U,i as N,r as nt,s as Pe}from"../chunks/Dl5udER_.js";import{h as Ie}from"../chunks/Bats36-G.js";import{a as it,C as lt,e as Le,b as ve,s as Se,f as _t}from"../chunks/Bs1WACQy.js";import{C as ct,c as dt,b as ut,d as ft,a as mt}from"../chunks/Bo6tdu1o.js";import{L as vt}from"../chunks/Dn_wVXEk.js";import{p as he}from"../chunks/Bq76yR1A.js";import{o as Ue}from"../chunks/CxXS0fUU.js";import{r as I}from"../chunks/CLGCMyX0.js";import{p as Ye}from"../chunks/B_Okd18j.js";import{A as ht}from"../chunks/BUPHNsP7.js";import{h as pt}from"../chunks/MiD8ojYV.js";import{s as gt,l as bt,a as yt,b as xt,e as wt,T as Et,t as Tt,r as At,D as Lt}from"../chunks/BGLwkG8r.js";import{b as St}from"../chunks/CMd_zdKF.js";import{i as De,s as Fe,a as kt}from"../chunks/V2q5a4YM.js";import{C as Pt}from"../chunks/Qqlmy7vx.js";import{C as Ut}from"../chunks/BMaQeBpq.js";import{f as Oe,B as Dt,S as Ft,e as Ot,g as Ct,i as zt,j as Mt,k as Nt,l as Rt,m as Yt,n as Ht,p as Wt,q as Xt,r as Gt,M as jt}from"../chunks/Bok9ALqm.js";import{t as Bt,s as It}from"../chunks/-QCXjV-k.js";import{S as ke}from"../chunks/hyL2fVoe.js";import{l as qe}from"../chunks/Bu9VL8Na.js";import{N as He}from"../chunks/Csfq34zk.js";import{i as We,F as qt,v as Kt,n as Jt,E as Qt}from"../chunks/CtEBPyZ8.js";import{t as Vt,m as Zt}from"../chunks/DXTMZfSv.js";import{D as $t}from"../chunks/BF2jAMtx.js";import{l as ea}from"../chunks/EmdLLuOy.js";import{l as ta}from"../chunks/E0pSqjZb.js";import{b as Xe}from"../chunks/gkPtKwZJ.js";class Ce{#e=new WeakMap;#t;#a;static entries=new WeakMap;constructor(e){this.#a=e}observe(e,t){var c=this.#e.get(e)||new Set;return c.add(t),this.#e.set(e,c),this.#o().observe(e,this.#a),()=>{var g=this.#e.get(e);g.delete(t),g.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#o(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var t of e){Ce.entries.set(t.target,t);for(var c of this.#e.get(t.target)||[])c(t)}}))}}var aa=new Ce({box:"border-box"});function me(o,e,t){var c=aa.observe(o,()=>t(o[e]));Be(()=>(at(()=>t(o[e])),c))}const oa=!0,ra=!0,ho=Object.freeze(Object.defineProperty({__proto__:null,prerender:oa,ssr:ra},Symbol.toStringTag,{value:"Module"})),Ae=(o,e=0)=>{let t=e;ot(()=>{o(++t)})};function sa(o,e){ae(e,!0);const t=U(e,"sync_color_scheme",3,gt),c=U(e,"load_color_scheme",3,bt),g=U(e,"save_color_scheme",3,yt),h=U(e,"load_theme",3,xt),F=U(e,"save_theme",3,wt),n=U(e,"themer",19,()=>new Et({theme:h()(e.theme_fallback),color_scheme:c()()}));Tt.set(n());const m=P(()=>n().theme.name),b=P(()=>a(m)===Lt.name?null:At(n().theme)),y=P(()=>a(b)?`<style>${a(b)}</style>`:null);Ae(x=>{const v=n().color_scheme;x!==1&&t()(v)}),Ae(x=>{const v=n().color_scheme;x!==1&&g()(v)}),Ae(x=>{const v=n().theme;x!==1&&F()(v)});var T=k();Ie("17coqft",x=>{var v=k(),X=f(v);{var K=L=>{var C=k(),_=f(C);pt(_,()=>a(y)),s(L,C)};N(X,L=>{a(y)&&L(K)})}s(x,v)});var A=f(T);Y(A,()=>e.children,n,()=>a(b),()=>a(y)),s(o,T),oe()}function na(o,e){Ut(o,{get run(){return e.run},icon:c=>{Me();var g=Ne();B(()=>de(g,e.icon)),s(c,g)},children:(c,g)=>{Me();var h=Ne();B(()=>de(h,e.content)),s(c,h)},$$slots:{icon:!0,default:!0}})}var ia=O("<li></li>");function la(o,e){const t=nt(e,["$$slots","$$events","$$legacy"]);var c=ia();it(c,()=>({role:"separator","aria-orientation":"vertical",...t,[lt]:{contextmenu_separator:!0}}),void 0,void 0,void 0,"svelte-14jtsvh"),s(o,c)}const _a=-2,ca=-2,da=750,ua=11,Ge=(o,e)=>!e&&(o instanceof HTMLElement||o instanceof SVGElement)&&!De(o)&&!kt(o),fa=o=>new Map([["Escape",()=>o.close()],["ArrowLeft",()=>o.collapse_selected()],["ArrowRight",()=>o.expand_selected()],["ArrowDown",()=>o.select_next()],["ArrowUp",()=>o.select_previous()],["Home",()=>o.select_first()],["End",()=>o.select_last()],[" ",()=>o.activate_selected()],["Enter",()=>o.activate_selected()]]),ma=o=>e=>{const t=o.get(e.key);!t||De(e.target)||(Fe(e),t())},va=(o,e,t)=>o+Math.min(0,t-(o+e)),ha=(o,e,t)=>o+Math.min(0,t-(o+e)),pa=(o,e=q)=>{Pt(o,Pe(e))},ga=(o,e=q)=>{na(o,Pe(e))},ba=(o,e=q)=>{la(o,Pe(e))};var ya=O('<div class="contextmenu_root svelte-tmo2ds" role="region"><!></div>'),xa=O('<div class="contextmenu_layout svelte-tmo2ds" aria-hidden="true"></div>'),wa=O('<ul class="contextmenu unstyled pane svelte-tmo2ds" role="menu" aria-label="context menu" tabindex="-1"></ul>'),Ea=O("<!> <!>  <!>",1);function Ta(o,e){ae(e,!0);const t=U(e,"contextmenu",19,()=>new ct),c=U(e,"open_offset_x",3,_a),g=U(e,"open_offset_y",3,ca),h=U(e,"bypass_with_tap_then_longpress",3,!0),F=U(e,"bypass_window",3,da),n=U(e,"bypass_move_tolerance",3,ua),m=U(e,"scoped",3,!1),b=U(e,"link_entry",3,pa),y=U(e,"text_entry",3,ga),T=U(e,"separator_entry",3,ba);dt.set(t());let A=j(void 0);const x=P(()=>t().layout),v=ut.set(),X=P(()=>va(t().x,v.width,a(x).width)),K=P(()=>ha(t().y,v.height,a(x).height));let L=j(void 0),C=j(void 0),_=j(void 0),z=j(void 0),d=j(void 0);const W=r=>{if(a(z)){i(z,!1),i(_,null),i(L,null),i(C,null),a(d)!=null&&(clearTimeout(a(d)),i(d,null));return}const{target:l}=r;Ge(l,r.shiftKey)&&(a(A)?.contains(l)||ft(l,r.clientX+c(),r.clientY+g(),t(),{link_enabled:b()!==null,text_enabled:y()!==null,separator_enabled:T()!==null})&&Fe(r))},ue=r=>{if(!h())return;const{touches:l,target:p}=r;if(t().opened||l.length!==1||!Ge(p,r.shiftKey)){i(_,null),i(L,null),i(C,null),i(z,!1),a(d)!=null&&(clearTimeout(a(d)),i(d,null));return}const{clientX:u,clientY:w}=l[0];if(a(_)!=null&&performance.now()-a(_)<F()&&Math.hypot(u-a(L),w-a(C))<n()){i(z,!0),i(_,null),i(L,null),i(C,null),a(d)!=null&&(clearTimeout(a(d)),i(d,null));return}i(_,performance.now(),!0),i(L,u,!0),i(C,w,!0),a(d)!=null&&clearTimeout(a(d)),i(d,setTimeout(()=>{i(_,null),i(L,null),i(C,null),i(d,null)},F()),!0)},fe=()=>{i(_,null),i(L,null),i(C,null),i(z,!1),a(d)!=null&&(clearTimeout(a(d)),i(d,null))},pe=r=>{a(A)&&!a(A).contains(r.target)&&t().close()},M=fa(t()),S=ma(M);var R=Ea();G("contextmenu",te,function(...r){(m()?void 0:W)?.apply(this,r)}),G("mousedown",te,function(...r){(t().opened?pe:void 0)?.apply(this,r)}),G("keydown",te,function(...r){(t().opened?S:void 0)?.apply(this,r)}),G("touchstart",te,function(...r){(m()||!h()?void 0:ue)?.apply(this,r)},!0,!0),G("touchcancel",te,function(...r){(m()||!h()?void 0:fe)?.apply(this,r)},!0);var J=f(R);{var re=r=>{var l=ya();l.__contextmenu=W;var p=D(l);Y(p,()=>e.children),E(l),G("touchstart",l,function(...u){(h()?ue:void 0)?.apply(this,u)},!0,!0),G("touchcancel",l,function(...u){(h()?fe:void 0)?.apply(this,u)},!0),s(r,l)},se=r=>{var l=k(),p=f(l);Y(p,()=>e.children),s(r,l)};N(J,r=>{m()?r(re):r(se,!1)})}var ne=H(J,2);{var ie=r=>{var l=xa();me(l,"clientWidth",p=>a(x).width=p),me(l,"clientHeight",p=>a(x).height=p),s(r,l)};N(ne,r=>{t().has_custom_layout||r(ie)})}var Q=H(ne,2);{var ge=r=>{var l=wa();let p;Le(l,20,()=>t().params,u=>u,(u,w)=>{var V=k(),be=f(V);{var ye=Z=>{var le=k(),xe=f(le);Y(xe,()=>w),s(Z,le)},Ke=Z=>{var le=k(),xe=f(le);{var Je=$=>{var _e=k(),we=f(_e);Y(we,()=>b()??q,()=>w.props),s($,_e)},Qe=$=>{var _e=k(),we=f(_e);{var Ve=ee=>{var ce=k(),Ee=f(ce);Y(Ee,()=>y()??q,()=>w.props),s(ee,ce)},Ze=ee=>{var ce=k(),Ee=f(ce);{var $e=Te=>{var ze=k(),et=f(ze);Y(et,()=>T()??q,()=>w.props),s(Te,ze)};N(Ee,Te=>{w.snippet==="separator"&&Te($e)},!0)}s(ee,ce)};N(we,ee=>{w.snippet==="text"?ee(Ve):ee(Ze,!1)},!0)}s($,_e)};N(xe,$=>{w.snippet==="link"?$(Je):$(Qe,!1)},!0)}s(Z,le)};N(be,Z=>{typeof w=="function"?Z(ye):Z(Ke,!1)})}s(u,V)}),E(l),St(l,u=>i(A,u),()=>a(A)),B(()=>p=ve(l,"",p,{transform:`translate3d(${a(X)??""}px, ${a(K)??""}px, 0)`})),me(l,"offsetWidth",u=>v.width=u),me(l,"offsetHeight",u=>v.height=u),s(r,l)};N(Q,r=>{t().opened&&r(ge)})}s(o,R),oe()}je(["contextmenu"]);var Aa=O('<div class="display_flex p_sm mb_sm"><!></div>'),La=O('<div class="font_size_xl font_family_serif mt_xl7 mb_md text_color_3"> </div>'),Sa=O("<!> ",1),ka=O('<span class="icon_xs"><!></span> ',1),Pa=O("<div><!></div>"),Ua=O("<!> <!>",1),Da=O('<div class="dashboard"><div class="height_100 width_100 position_fixed top_0 left_0"><!></div> <div class="height_100 position_fixed top_0 left_0 overflow_auto scrollbar_width_thin"><div class="p_sm"><nav class="font_size_lg"></nav></div></div> <button type="button" class="position_fixed bottom_0 left_0 icon_button plain border_radius_0"><!></button></div>');function Fa(o,e){ae(e,!0);const t=Oe.get(),c=180,g=P(()=>t.ui.show_sidebar?c:0);let h=j(0);const F=3;let n=j(!1);Ue(_=>{!a(n)&&_.from?.route.id==="/"&&_.to?.route.id!=="/"&&(console.log("resetting"),i(h,0))});const m=P(()=>{const _=structuredClone(Zt);if(t.futuremode){const z=_.find(W=>W.group==="main");z&&z.items.unshift({label:"tabs",href:I("/tabs"),icon:qt});const d=_.find(W=>W.group==="main");d&&d.items.push({label:"projects",href:I("/projects"),icon:Kt})}return _}),b=P(()=>(t.ui.show_sidebar?"hide sidebar":"show sidebar")+" [backtick `]");var y=Da();G("keydown",te,_=>{_.key==="`"&&!De(_.target)&&(t.ui.toggle_sidebar(),Fe(_))},!0);let T;var A=D(y);ve(A,"",{},{"padding-left":"var(--sidebar_width)"});var x=D(A);Y(x,()=>e.children),E(A);var v=H(A,2);ve(v,"",{},{width:"var(--sidebar_width)"});var X=D(v),K=D(X);Le(K,21,()=>a(m),_=>_.group,(_,z)=>{var d=Ua(),W=f(d);{var ue=M=>{var S=Aa(),R=D(S);{let J=P(()=>I("/")),re=P(()=>t.futuremode?"futuremode":"home");He(R,{get href(){return a(J)},get title(){return a(re)},class:"click_effect_scale",onclick:()=>{a(n)?he.url.pathname===I("/")&&(t.futuremode=!t.futuremode):(rt(h),a(h)>=F&&(t.futuremode=!t.futuremode,i(n,!0)))},children:(se,ne)=>{{let ie=P(()=>t.futuremode?"var(--color_h_5)":void 0),Q=P(()=>t.futuremode?"flip_x":"");ke(se,{get data(){return qe},size:"var(--icon_size_md)",get fill(){return a(ie)},style:"transition: transform 200ms ease",get class(){return a(Q)}})}},$$slots:{default:!0}})}E(S),s(M,S)},fe=M=>{var S=La(),R=D(S,!0);E(S),B(()=>de(R,a(z).group)),s(M,S)};N(W,M=>{a(z).group==="main"?M(ue):M(fe,!1)})}var pe=H(W,2);Le(pe,17,()=>a(z).items,M=>M.label,(M,S)=>{var R=Pa(),J=D(R);{const re=(ne,ie=q)=>{var Q=k(),ge=f(Q);{var r=p=>{var u=Sa(),w=f(u);We(w,{get glyph(){return a(S).icon},class:"icon_xs"});var V=H(w);B(()=>de(V,` ${a(S).label??""}`)),s(p,u)},l=p=>{var u=ka(),w=f(u),V=D(w);{let ye=P(()=>ie()?"var(--link_color)":"var(--text_color_1)");ke(V,{get data(){return a(S).icon},get fill(){return a(ye)},size:"var(--icon_size_xs)"})}E(w);var be=H(w);B(()=>de(be,` ${a(S).label??""}`)),s(p,u)};N(ge,p=>{typeof a(S).icon=="string"?p(r):p(l,!1)})}s(ne,Q)};let se=P(()=>Vt(t,a(S).label,a(S).href));He(J,{get href(){return a(se)},children:re,$$slots:{default:!0}})}E(R),Bt(3,R,()=>It),s(M,R)}),s(_,d)}),E(K),E(X),E(v);var L=H(v,2);L.__click=()=>t.ui.toggle_sidebar();var C=D(L);{let _=P(()=>t.ui.show_sidebar?Jt:Qt);We(C,{get glyph(){return a(_)}})}E(L),E(y),B(()=>{T=ve(y,"",T,{"--sidebar_width":`${a(g)??""}px`}),Se(L,"aria-label",a(b)),Se(L,"title",a(b))}),s(o,y),oe()}je(["click"]);var Oa=O('<div class="box"><div class="pane p_xl3"><section class="box mb_xl3"><h1 class="mb_0">work in progress</h1></section> <section class="box pb_xl3"><footer><a class="row p_md"><span class="font_size_lg mr_md">about</span> <!></a></footer></section></div></div>');function Ca(o,e){ae(e,!0);const t=Oe.get();Ue(()=>{t.ui.show_main_dialog&&t.api.toggle_main_menu({show:!1})});var c=k(),g=f(c);{var h=F=>{$t(F,{onclose:()=>t.api.toggle_main_menu({show:!1}),layout:"page",children:(n,m)=>{var b=Oa(),y=D(b),T=H(D(y),2),A=D(T),x=D(A),v=H(D(x),2);ke(v,{get data(){return qe},size:"var(--icon_size_md)"}),E(x),E(A),E(T),E(y),E(b),B(X=>Se(x,"href",X),[()=>I("/about")]),s(n,b)},$$slots:{default:!0}})};N(g,F=>{!e.disabled&&t.ui.show_main_dialog&&F(h)})}s(o,c),oe()}var za=O('<div class="height_100 overflow_auto"><!></div>'),Ma=O("<!> <!>",1);function Na(o,e){ae(e,!0),Oe.set(e.app),sa(o,{children:(t,c)=>{Ta(t,{children:(g,h)=>{var F=Ma(),n=f(F);Ca(n,{});var m=H(n,2);Fa(m,{children:(b,y)=>{var T=za(),A=D(T);Y(A,()=>e.children,()=>e.app),E(T),s(b,T)},$$slots:{default:!0}}),s(g,F)},$$slots:{default:!0}})},$$slots:{default:!0}}),oe()}const Ra=()=>({providers:Xt,models:Wt,system_message:Ht,output_token_max:Yt,temperature:Rt,seed:Nt,top_k:Mt,top_p:zt,frequency_penalty:Ct,presence_penalty:Ot,stop_sequences:Ft,bots:Dt});function po(o,e){ae(e,!0),tt(()=>{const n=Ra();t.add_providers(n.providers.map(m=>Gt.parse(m))),t.models.add_many(n.models.map(m=>jt.parse(m))),t.api.session_load(),t.ollama.refresh()}),ea.set(new vt(ta));const t=new ht;window.app=window.app=t,st(()=>{t.chats.selected_id=Ye(e.params.chat_id),t.prompts.selected_id=Ye(e.params.prompt_id)}),Ue(()=>{const{pathname:n}=he.url;n===I("/chats")?t.chats.selected_id_last_non_null=null:n===I("/prompts")&&(t.prompts.selected_id_last_non_null=null)});var c=k();Ie("12qhfyh",n=>{Be(()=>{Re.title="Zzz"})}),_t(Re.body,()=>mt([{snippet:"text",props:{content:"settings",icon:"?",run:()=>{console.log("show main dialog"),t.api.toggle_main_menu({show:!0})}}},{snippet:"text",props:{content:"reload",icon:"âŸ³",run:()=>{location.reload()}}}]));var g=f(c);{var h=n=>{var m=k(),b=f(m);Y(b,()=>e.children),s(n,m)},F=n=>{Na(n,{get app(){return t},children:(m,b)=>{var y=k(),T=f(y);Y(T,()=>e.children),s(m,y)},$$slots:{default:!0}})};N(g,n=>{he.url.pathname===Xe||he.url.pathname.startsWith(Xe+"/")?n(h):n(F,!1)})}s(o,c),oe()}export{po as component,ho as universal};
