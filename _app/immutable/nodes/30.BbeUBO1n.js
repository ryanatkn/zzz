import"../chunks/DsnmJJEf.js";import{k as T,i as h,l as y,j as S,a7 as xe,p as se,e as U,a as D,b as c,f as P,d as a,r as i,t as J,c as re,s as b,ah as ze,n as Y,h as N}from"../chunks/DsYFF3e0.js";import{e as ee,r as be,a as pe,d as de,s as me}from"../chunks/D6t6EFf3.js";import{p as ve,i as K}from"../chunks/Nwe5dM3j.js";import{q as B,h as G,E as Ie,t as W,j as je,I as he,s as Ee,i as Le,o as Te,P as Pe,l as Ae,r as He,w as Be,Q as Re}from"../chunks/dRtQjgBD.js";import{m as ce,C as _e,k as F,_ as Ce,v as Ze,h as we,o as ue,n as ye,q as O,H as le,j as ne}from"../chunks/23rF6zAW.js";import{I as Ge,a as Ye,b as De,d as Ke,f as Me}from"../chunks/S68OugPJ.js";import{b as Oe}from"../chunks/CNYcfd7V.js";import{s as q,i as Se}from"../chunks/BlUH4YWX.js";import{k as Ue}from"../chunks/BN1JsYAd.js";import{R as Fe}from"../chunks/2DjJa-uU.js";import{E as fe}from"../chunks/vDy0Ger1.js";const te=_e.extend({title:F(),url:F(),selected:we().default(!1),refresh_counter:Ze().default(0),type:Ce(["raw","embedded_html","external_url"]),content:F().optional()}).meta({cell_class_name:"Browser_Tab"});class Q extends ce{#e=T();get title(){return h(this.#e)}set title(e){y(this.#e,e,!0)}#t=T();get url(){return h(this.#t)}set url(e){y(this.#t,e,!0)}#s=T();get selected(){return h(this.#s)}set selected(e){y(this.#s,e,!0)}#r=T();get refresh_counter(){return h(this.#r)}set refresh_counter(e){y(this.#r,e,!0)}#a=T();get type(){return h(this.#a)}set type(e){y(this.#a,e,!0)}#i=T();get content(){return h(this.#i)}set content(e){y(this.#i,e,!0)}constructor(e){super(te,e),this.init()}refresh(){this.refresh_counter++}}ue(Q);const $={future:{title:"Zzz in the future",url:"https://www.zzz.software/future",content:`
			<article style="padding: 10px;">
				<header>
					<h1>Zzz in the future</h1>
				</header>
				<section style="width: 300px">
					<p>I'm trying to see if Zzz has legs. Maybe it remains a portfolio item that helps me get a job building similar things, ideally with the same base tech. I hope it gets enough traction with users to justify my continued work on it. I'm currently working on it and its deps full-time and feeling motivated, but the social environment is a poor one.</p>
					<p>I can say for certain I won't take investment/VC for Zzz or its dependencies or change them from being permissively licensed open source. I'm sympathetic to copyleft but I feel this is the better way, for me with this project, to make better software that's useful to more people. If I change my mind and want to use a copyleft license, or want to raise money from investors, it will have to be with a new project.</p>
					<p>In terms of roadmap, I plan to work on the browser functionality sometime after the sites proof of concept with basic IDE/CMS features, so it'll be a while. If you were looking for a roadmap let me know and I can start one.</p>
					<p>You can participate! See the <a href="https://github.com/ryanatkn/zzz" target="_blank" rel="noopener">repo</a>.</p>
				</section>
			</article>
		`},new_tab:{content:`
			<div style="padding: 20px; font-family: system-ui;">
				<h1>new tab</h1>
				<ul>
					<li><a href="https://www.zzz.software/about" target="_blank" rel="noopener">about Zzz</a></li>
					<li><a href="https://github.com/ryanatkn/zzz" target="_blank" rel="noopener">source code</a></li>
				</ul>
			</div>
		`}},H=ye(),qe=[{id:O(),title:"Zzz is a browser",url:"https://www.zzz.software/tabs",type:"raw",selected:!0,refresh_counter:0,created:H,updated:H},{id:O(),title:$.future.title,selected:!1,url:$.future.url,type:"embedded_html",content:$.future.content,refresh_counter:0,created:H,updated:H},{id:O(),title:"Moss",selected:!1,url:"https://moss.ryanatkn.com/",type:"external_url",refresh_counter:0,created:H,updated:H},{id:O(),title:"Fuz",selected:!1,url:"https://fuz.dev/",type:"external_url",refresh_counter:0,created:H,updated:H}],Je=_e.extend({tabs:ne(te).default(()=>[]),recently_closed_tabs:ne(te).default(()=>[])}).meta({cell_class_name:"Browser_Tabs"});class ge extends ce{items=new Ge({indexes:[Ye({key:"url",extractor:e=>e.url,query_schema:F()}),De({key:"manual_order",compute:e=>e.values})]});#e=S(()=>this.items.derived_index("manual_order"));get ordered_tabs(){return h(this.#e)}set ordered_tabs(e){y(this.#e,e)}#t=T(xe([]));get recently_closed_tabs(){return h(this.#t)}set recently_closed_tabs(e){y(this.#t,e,!0)}#s=S(()=>this.ordered_tabs.find(e=>e.selected));get selected_tab(){return h(this.#s)}set selected_tab(e){y(this.#s,e)}#r=S(()=>this.selected_tab?.url||"");get selected_url(){return h(this.#r)}set selected_url(e){y(this.#r,e)}constructor(e){super(Je,e),this.decoders={tabs:t=>{if(Array.isArray(t)){this.items.clear();for(const o of t){const r=new Q({app:this.app,json:o});this.items.add(r)}}return le},recently_closed_tabs:t=>(Array.isArray(t)&&(this.recently_closed_tabs=t.map(o=>new Q({app:this.app,json:o}))),le)},this.init()}add(e){const t=new Q({app:this.app,json:e});this.items.add(t)}add_new_tab(){for(const t of this.items.by_id.values())t.selected=!1;const e=ye();this.add({id:O(),title:"new tab",selected:!0,url:"/newtab",type:"embedded_html",content:$.new_tab.content,refresh_counter:0,created:e,updated:e})}close(e){const t=this.ordered_tabs;if(e>=0&&e<t.length){const o=t[e],r=o.selected;if(this.recently_closed_tabs.push(o),this.items.remove(o.id),r&&this.ordered_tabs.length>0){const m=Math.min(this.ordered_tabs.length-1,e);this.ordered_tabs[m].selected=!0}}}reopen_last_closed_tab(){if(this.recently_closed_tabs.length>0){const e=this.recently_closed_tabs.pop();if(e){if(e.selected)for(const t of this.items.by_id.values())t.selected=!1;this.items.add(e)}}}select(e){const t=this.ordered_tabs;if(e>=0&&e<t.length)for(let o=0;o<t.length;o++)t[o].selected=o===e}update_url(e){const t=this.selected_tab;t&&(t.url=e,t.type==="embedded_html"&&e!=="~newtab"&&e!=="/newtab"&&(t.type="external_url",t.content=void 0),t.type==="external_url"&&t.refresh())}refresh_selected(){const e=this.selected_tab;e&&e.refresh()}reorder_tabs(e,t){this.items.indexes.manual_order=Ke(this.ordered_tabs,e,t)}}ue(ge);const We=_e.extend({tabs:ne(te).default(()=>[]),edited_url:F().default(""),browserified:we().default(!1)}).meta({cell_class_name:"Browser"});class ke extends ce{tabs=new ge({app:this.app});#e=T();get edited_url(){return h(this.#e)}set edited_url(e){y(this.#e,e,!0)}#t=T();get browserified(){return h(this.#t)}set browserified(e){y(this.#t,e,!0)}#s=S(()=>this.edited_url!==this.tabs.selected_url);get url_edited(){return h(this.#s)}set url_edited(e){y(this.#s,e)}constructor(e){super(We,e),this.decoders={tabs:t=>{if(Array.isArray(t)){for(const r of t)this.tabs.add(r);!this.tabs.ordered_tabs.find(r=>r.selected)&&this.tabs.ordered_tabs.length>0&&(this.tabs.ordered_tabs[0].selected=!0),this.edited_url=this.tabs.selected_url}return le}},this.init()}navigate_to(e){this.tabs.update_url(e),this.edited_url=e}go_back(){}go_forward(){}refresh(){this.tabs.refresh_selected()}add_new_tab(){this.tabs.add_new_tab(),this.edited_url=this.tabs.selected_url}close_tab(e){this.tabs.close(e),this.edited_url=this.tabs.selected_url}reopen_last_closed_tab(){this.tabs.reopen_last_closed_tab(),this.edited_url=this.tabs.selected_url}select_tab(e){this.tabs.select(e),this.edited_url=this.tabs.selected_url}submit_edited_url(){this.navigate_to(this.edited_url)}reorder_tab(e,t){this.tabs.reorder_tabs(e,t)}}ue(ke);var Ve=P('<div class="iframe_container svelte-jej3gh"><iframe sandbox="allow-scripts allow-popups" class="svelte-jej3gh"></iframe></div>'),Xe=P('<div class="iframe_container svelte-jej3gh"><iframe sandbox="allow-scripts allow-same-origin" class="svelte-jej3gh"></iframe></div>'),Ne=P('<div class="p_lg"><!></div>');function Qe(d,e){se(e,!0);const t=ve(e,"tab",7);function o(I){const k=I.target;try{const l=k.contentDocument?.title;l?.trim()&&l!==t().title&&(t().title=l.trim())}catch(l){console.log("Unable to access iframe content:",l)}}const r=S(()=>t().type==="embedded_html"&&t().content?`<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<style>
		:root {
			color-scheme: light dark;
		}
		body {
			background: light-dark(white, #1a1a1a);
			color: light-dark(#000, #fff);
			margin: 0;
		}
	</style>
</head>
<body>
${t().content}
</body>
</html>`:t().content);var m=U(),g=D(m);Ue(g,()=>t().refresh_counter,I=>{var k=U(),l=D(k);{var _=v=>{var f=Ve(),j=a(f);i(f),J(()=>{B(j,"title",t().title),B(j,"srcdoc",h(r))}),ee("load",j,o),be(j),c(v,f)},w=v=>{var f=U(),j=D(f);{var A=p=>{var x=Xe(),z=a(x);i(x),J(()=>{B(z,"title",t().title),B(z,"src",t().url)}),ee("load",z,o),be(z),c(p,x)},R=p=>{var x=Ne(),z=a(x);pe(z,()=>e.children),i(x),c(p,x)};K(j,p=>{t().type==="external_url"?p(A):p(R,!1)},!0)}c(v,f)};K(l,v=>{t().type==="embedded_html"?v(_):v(w,!1)})}c(I,k)}),c(d,m),re()}var $e=(d,e)=>e.onselect(e.index),et=(d,e)=>{(d.key==="Enter"||d.key===" ")&&(q(d),e.onselect(e.index))},tt=(d,e)=>{q(d),e.onclose(e.index)},st=P('<div><div role="button" tabindex="0"><div class="ellipsis font_weight_400 flex_1"><!> <small class="ml_xs"> </small></div> <button type="button" class="tab_close_button plain icon_button compact border_radius_md ml_sm" title="close tab"><!></button></div></div>');function rt(d,e){se(e,!0);var t=st();let o;var r=a(t);let m;r.__click=[$e,e],r.__keydown=[et,e];var g=a(r),I=a(g);G(I,{glyph:"⎕"});var k=b(I,2),l=a(k,!0);i(k),i(g);var _=b(g,2);_.__click=[tt,e];var w=a(_);G(w,{get glyph(){return Ie}}),i(_),i(r),i(t),J((v,f)=>{o=W(t,1,"browser_tab_container svelte-3wfu0d",null,o,v),m=W(r,1,"browser_tab_button border_radius_0 plain px_sm py_xs svelte-3wfu0d",null,m,f),B(r,"aria-label",`Tab ${e.tab.title}`),B(r,"aria-pressed",e.tab.selected),me(l,e.tab.title),B(_,"aria-label",`close tab ${e.tab.title}`)},[()=>({selected:e.tab.selected}),()=>({selected:e.tab.selected})]),c(d,t),re()}de(["click","keydown"]);var at=P('<li class="display_flex"><!></li>'),it=(d,e)=>e().add_new_tab(),ot=(d,e)=>e().go_back(),lt=(d,e)=>e().go_forward(),nt=(d,e)=>e().refresh(),dt=()=>{alert("not yet, thanks for clicking")},ct=P('<div class="browser_container svelte-13pef9z"><div class="browser_chrome svelte-13pef9z"><ul class="browser_tab_bar unstyled display_flex overflow_x_auto overflow_y_hidden scrollbar_width_thin svelte-13pef9z"><!> <div class="p_sm"><button type="button" class="plain ml_xs border_radius_md" title="new tab"><!></button></div></ul> <div class="browser_controls display_flex gap_sm p_xs4"><div class="browser_nav_buttons display_flex gap_xs"><button type="button" class="icon_button plain p_xs border_radius_lg" title="back" disabled><!></button> <button type="button" class="icon_button plain p_xs border_radius_lg" title="forward" disabled><!></button> <button type="button" class="icon_button plain p_xs border_radius_lg" title="refresh"><!></button></div> <div class="browser_address_bar flex_1 svelte-13pef9z"><input type="text"/></div> <div class="display_flex gap_xs"><button type="button" class="icon_button plain p_xs" title="main menu">☰</button></div></div></div> <div class="browser_content svelte-13pef9z"><!></div></div>');function _t(d,e){se(e,!0);const t=ve(e,"browser",7),o=new Fe({item_class:null});var r=ct();ee("keydown",ze,s=>{if(!Se(s.target)&&(s.ctrlKey&&!s.shiftKey&&!s.altKey&&s.key==="q"&&(q(s),t().add_new_tab()),s.ctrlKey&&s.shiftKey&&s.key==="Q"&&(q(s),t().reopen_last_closed_tab()),s.ctrlKey&&s.altKey&&!s.shiftKey&&s.key==="q")){q(s);const E=t().tabs.ordered_tabs.findIndex(n=>n.selected);E!==-1&&t().close_tab(E)}});var m=a(r),g=a(m),I=a(g);je(I,19,()=>t().tabs.ordered_tabs,s=>s.id,(s,E,n)=>{var u=at(),Z=a(u);rt(Z,{get tab(){return h(E)},get index(){return h(n)},onselect:oe=>t().select_tab(oe),onclose:oe=>t().close_tab(oe)}),i(u),he(u,()=>o.item({index:h(n)})),c(s,u)});var k=b(I,2),l=a(k);l.__click=[it,t],Ee(l,"",{},{width:"32px","min-width":"32px",height:"32px","min-height":"32px"});var _=a(l);G(_,{get glyph(){return Le}}),i(l),i(k),i(g),he(g,()=>o.list({onreorder:(s,E)=>t().reorder_tab(s,E)}));var w=b(g,2),v=a(w),f=a(v);f.__click=[ot,t];var j=a(f);G(j,{get glyph(){return Te}}),i(f);var A=b(f,2);A.__click=[lt,t];var R=a(A);G(R,{get glyph(){return Pe}}),i(A);var p=b(A,2);p.__click=[nt,t];var x=a(p);G(x,{get glyph(){return Ae}}),i(p),i(v);var z=b(v,2),L=a(z);He(L);let C;i(z);var M=b(z,2),ae=a(M);ae.__click=[dt],i(M),i(w),i(m);var V=b(m,2),ie=a(V);{var X=s=>{Qe(s,{get tab(){return t().tabs.selected_tab},children:(E,n)=>{var u=U(),Z=D(u);pe(Z,()=>e.children),c(E,u)},$$slots:{default:!0}})};K(ie,s=>{t().tabs.selected_tab&&s(X)})}i(V),i(r),J(s=>{C=W(L,1,"width_100 plain svelte-13pef9z",null,C,s),B(L,"placeholder",Be)},[()=>({url_edited:t().url_edited})]),ee("keypress",L,s=>{s.key==="Enter"&&t().submit_edited_url()}),Oe(L,()=>t().edited_url,s=>t().edited_url=s),c(d,r),re()}de(["click"]);var ut=P(`<aside>⚠️⚠️ This is just a demo of planned functionality, nothing works like it should. Zzz needs a
				native installation to function like a real browser. The initial version will use Chromium
				via Electron, and long term, a user-friendly design would allow choosing your engine among
				Chromium, Firefox, Safari, Ladybird, etc.</aside>`),bt=P(`<h1><!> tabs</h1> <section class="width_upto_md"><!> <p>Zzz can be used to build installable apps that extend the web browser, using the form factor
			you already know well -- imagine your current browser, and then add a sidebar on the left like
			the one on this page, then <button type="button"> </button> I'm planning to make an Electron-based version of Zzz first.</p> <p>And users don't have to buy in, either -- the basic browser UX is unchanged. Press <code>[backtick \`]</code> to <button type="button"><!></button> (that's just the current keybinding, it will probably change, also see the button at the bottom
			left corner of this window)</p> <p>This simple change recontextualizes the web's UX -- instead of the browser being its own silo,
			users compose tabs in a larger integrated system that's open and extensible by design.</p> <p>As a simple example, you could add metadata like tags to both your browser tabs and files,
			both local and in the cloud, so you can find things no matter their type or location. Maybe
			you want to summon UI that leverages that data for specific needs in specific contexts --
			without any technical knowledge, third parties, or unnecessary friction. The best usecases are
			still unknown, and today's browsers weren't designed for LLMs or experimentation at this
			level.</p> <p>I think that by optimizing for UX, Zzz and a lot of software is converging on similar
			architectures. I'm not well-read in The Literature or staying current with the design or
			product communities, but some of my favorite writing is from Ink and Switch: <!> and <!>. I think that we can all have software that's really nice to use, not that expensive to
			produce, that also respects individual rights and is designed for our benefit, that <small class="font_size_xs">UNLEASHES THE FULL POWER OF THE WEB</small>, and integrates our
			experience across the web and our devices how we each prefer.</p></section>`,1),ht=P('<div class="p_lg"><!></div>');function Et(d,e){se(e,!0);const t=l=>{var _=bt(),w=D(_),v=a(w);G(v,{get glyph(){return Re}}),Y(),i(w);var f=b(w,2),j=a(f);{var A=n=>{var u=ut();c(n,u)};K(j,n=>{r.browserified&&n(A)})}var R=b(j,2),p=b(a(R));p.__click=()=>r.browserified=!r.browserified;let x;var z=a(p);i(p),Y(),i(R);var L=b(R,2),C=b(a(L),3);let M;C.__click=()=>{o.ui.toggle_sidebar(),r.browserified||(r.browserified=!0)};var ae=a(C);{var V=n=>{var u=N("remember your power");c(n,u)},ie=n=>{var u=N("pretend it's all a dream");c(n,u)};K(ae,n=>{o.ui.show_sidebar?n(ie,!1):n(V)})}i(C),Y(),i(L);var X=b(L,6),s=b(a(X));fe(s,{href:"https://www.inkandswitch.com/local-first/",children:(n,u)=>{Y();var Z=N("local-first");c(n,Z)},$$slots:{default:!0}});var E=b(s,2);fe(E,{href:"https://www.inkandswitch.com/malleable-software/",children:(n,u)=>{Y();var Z=N("malleable software");c(n,Z)},$$slots:{default:!0}}),Y(3),i(X),i(f),J((n,u)=>{x=W(p,1,"inline compact",null,x,n),me(z,`${r.browserified?"un":""}browserify!`),M=W(C,1,"inline compact",null,M,u)},[()=>({color_i:!r.browserified,color_h:r.browserified}),()=>({color_d:o.ui.show_sidebar,color_f:!o.ui.show_sidebar})]),c(l,_)},o=Me.get(),r=o.browser??=new ke({app:o,json:{tabs:qe}});var m=U(),g=D(m);{var I=l=>{_t(l,{get browser(){return r},children:(_,w)=>{t(_)},$$slots:{default:!0}})},k=l=>{var _=ht(),w=a(_);t(w),i(_),c(l,_)};K(g,l=>{r.browserified?l(I):l(k,!1)})}c(d,m),re()}de(["click"]);export{Et as component};
